<?xml version="1.0" encoding="utf-8"?>
<ItemRenderer itemID="ITEM_ID_BREAKABLE_BLOCK" enableServerUpdate="true">
	<Data>
		<Sprite name="s_sprite" fileName="game/tiles_page17.rttex" textureSize="32" frame="8,10" />
		
		<Animations>
			<SpriteAnimation name="a_On" sprite="s_sprite" playOnState="Collision.On">
				<Frame>8,10</Frame>
			</SpriteAnimation>
			<SpriteAnimation name="a_Off" sprite="s_sprite" animTime="600" playOnState="Collision.Off">
				<Frame>9,10</Frame>
				<Frame>10,10</Frame>
				<Frame>11,10</Frame>
			</SpriteAnimation>
			<SpriteCurveAnimation name="s_sprite" sprite="s_fade" animTime="800" playOnState="Collision.Off">
				<Curve name="alpha">
					<KeyFrame>0.f, 0.f</KeyFrame>
					<KeyFrame>1.f, 0.f</KeyFrame>
				</Curve>
			</SpriteCurveAnimation>	
		</Animations>
		
		<StateMachines>
			<StateMachine name="Collision">
				<States>
					<State name="Off"/>
					<State name="On"/>
				</States>
				<Transitions>
					<Transition to="Off" from="On">
						<Condition type="or">
							<CheckNpcHealth onlyBoss="true" operatorType="LessOrEqual">50</CheckNpcHealth>
						</Condition>
					</Transition>
					<Transition to="On" from="Off">
						<Condition type="or">
							<CheckNpcHealth onlyBoss="true" operatorType="Greater">50</CheckNpcHealth>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>
		</StateMachines>
		
		<VariableMap>
			<Set name="HideTimer">0.5</Set>
			<Set name="DeltaTime">0.0</Set>
		</VariableMap>

	</Data>
	<RenderRules>
		<Update>
			<SetTileFlagOff onState="Collision.On">TILE_FLAG_IS_ON</SetTileFlagOff>
			<SetTileFlagOn onState="Collision.Off">TILE_FLAG_IS_ON</SetTileFlagOn>
			<Group onState="Collision.Off">
				<ArithmethicOperation LeftHandVariableName="HideTimer" RightHandVariableName="DeltaTime" OperationType="Substract"/>
			</Group>
			<Group onState="Collision.On">
				<ArithmethicOperation LeftHandVariableName="HideTimer" RightHandVariableName="0.5" OperationType="Set"/>
			</Group>
		</Update>
		<Render>
			<StopIf>
				<CompareCustomVariable operatorType="Less" VariableNameToCompare="HideTimer">0</CompareCustomVariable>
			</StopIf>
			<SpriteRender name="s_sprite"/>
		</Render>
	</RenderRules>
</ItemRenderer>