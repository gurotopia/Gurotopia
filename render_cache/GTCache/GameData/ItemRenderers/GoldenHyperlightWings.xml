<?xml version="1.0" encoding="utf-8"?>
<ItemRenderer>
	<Data>
		<StateMachines>
			<StateMachine name="Motion">
				<States>
					<State name="Idle" />
					<State name="Dance" />
					<State name="Vertical" />
				</States>
				<Transitions>
					<Transition to="Idle" from="Dance|Vertical">
						<Condition type="and">
							<IsAction>IDLE</IsAction>
							<IsAction operatorType="NotEqual">FALL</IsAction>
							<IsAction operatorType="NotEqual">JUMP</IsAction>
							<IsDancing>false</IsDancing>
						</Condition>
					</Transition>
					<Transition to="Dance" from="Idle|Vertical">
						<Condition>
							<IsDancing>true</IsDancing>
						</Condition>
					</Transition>
					<Transition to="Vertical" from="Dance|Idle">
						<Condition type="and">
							<IsAction operatorType="NotEqual">IDLE</IsAction>

							<IsVariableFloat name="speed.y" operator="Greater" abs="true">0</IsVariableFloat>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>

			<StateMachine name="Facing">
				<States>
					<State name="Left"/>
					<State name="Right"/>
				</States>
				<Transitions>
					<Transition to="Left" from="Right">
						<Condition>
							<IsFacingLeft>true</IsFacingLeft>
						</Condition>
					</Transition>
					<Transition to="Right" from="Left">
						<Condition>
							<IsFacingLeft>false</IsFacingLeft>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>

			<StateMachine name="Movement">
				<States>
					<State name="None"/>
					<State name="Movement" />
				</States>
				<Transitions>
					<Transition to="None" from="Movement">
						<Condition>
							<IsVariableFloat name="speed.length" operator="Less" abs="true">0.1</IsVariableFloat>
						</Condition>
					</Transition>
					<Transition to="Movement" from="None">
						<Condition>
							<IsVariableFloat name="speed.length" operator="Greater" abs="true">0</IsVariableFloat>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>
		</StateMachines>


		<Sprite name="s_wing" fileName="game/player_cosmetics4.rttex" textureSize="32" frame="16,3"/>
		<Sprite name="s_wing_right" fileName="game/player_cosmetics4.rttex" textureSize="32" frame="16,3"/>
		<Sprite name="s_back_strap" fileName="game/player_cosmetics4.rttex" textureSize="32" frame="18,3"/>
		<Sprite name="s_mist_particle" fileName="game/particles12.rttex" textureSize="32" frame="23,10"/>
		<Sprite name="s_glitter_particle" fileName="game/particles12.rttex" textureSize="32" frame="24,10"/>
		<Animations>

			<SpriteAnimation name="s_wing_dance_Animation" sprite="s_wing" animTime="400" isLoop="true" playOnState="Motion.Dance">
				<Frame>16,3</Frame>
				<Frame>17,3</Frame>
			</SpriteAnimation>						
			<SpriteAnimation name="s_wing_2_dance_Animation" sprite="s_wing_right" animTime="400" isLoop="true" playOnState="Motion.Dance">
				<Frame>16,3</Frame>
				<Frame>17,3</Frame>
			</SpriteAnimation>			
	

			<SpriteAnimation name="s_wing_idle_Animation" sprite="s_wing" animTime="50" isLoop="true" playOnState="Motion.Idle">
				<Frame>16,3</Frame>
			</SpriteAnimation>			
			<SpriteAnimation name="s_wing_2_idle_Animation" sprite="s_wing_right" animTime="50" isLoop="true" playOnState="Motion.Idle">
				<Frame>16,3</Frame>
			</SpriteAnimation>


			<CurveAnimationVec4 name="staff_fixed_rotation" autoPlay="true" isLoop="true" animTime="2110">
				<Curve name="hair_rotation">
					<KeyFrame>0.f, 25,0,0,1</KeyFrame>
					<KeyFrame>0.5f, 15,0,0,1</KeyFrame>
					<KeyFrame>1.f, 25,0,0,1</KeyFrame>
				</Curve>
			</CurveAnimationVec4> 			
			
			
			<CurveAnimationVec4 name="staff_fixed_rotation2" autoPlay="true" isLoop="true" animTime="2110">
				<Curve name="hair_rotation_SECOND">
					<KeyFrame>0.f, -15,0,0,1</KeyFrame>
					<KeyFrame>0.5f, -25,0,0,1</KeyFrame>
					<KeyFrame>1.f, -15,0,0,1</KeyFrame>
				</Curve>
			</CurveAnimationVec4> 
			


		</Animations>
		<ParticleSystems>
			<ParticleSystem name="MistParticles" updateStage="RenderBackpack" updateState="Movement.Movement">
				<Emitter>
					<Set name="offset">0, -15</Set>
					<Set name="emissionInterval">0.025</Set>
					<Set name="infParticles">true</Set>
					<Set name="infLifeTime">true</Set>
					<Set name="particlesPerEmission">8</Set>
					<Set name="particlesToEmit">8</Set>
				</Emitter>
				<Particle angleRelativeToPlayerSpeed="true">
					<Select name="offset" input="particleIndex">
						<Item>-24, 0</Item>
						<Item>-8, 0</Item>
						<Item>8, 0</Item>
						<Item>24, 0</Item>
						<Item>-24, 0</Item>
						<Item>-8, 0</Item>
						<Item>8, 0</Item>
						<Item>24, 0</Item>
					</Select>
					<Set name="sprite">s_mist_particle</Set>
					<Set name="isBackgroundParticle">true</Set>
					<Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 1</KeyFrame>
						<KeyFrame>0.3, 1</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
					<Set name="lifeTime">0.5</Set>
				</Particle>
			</ParticleSystem>

			<ParticleSystem name="EmberLeftParticleLeft" updateStage="RenderBackpack" updateState="Movement.Movement">
				<Emitter>
					<Set name="offset">-20, -15</Set>
					<Set name="emissionInterval">0.025</Set>
					<Set name="infParticles">true</Set>
					<Set name="infLifeTime">true</Set>
					<Set name="particlesPerEmission">1</Set>
					<Set name="particlesToEmit">1</Set>
				</Emitter>
				<Particle angleRelativeToPlayerSpeed="true">
					<Set name="sprite">s_glitter_particle</Set>
					<Set name="inSpecificOrder">true</Set>
					<Set name="relativeToEmitter">false</Set>
					<Random name="offset" min="-8, -8" max="8, 8" />
					<Set name="renderAlignment">CENTER</Set>
					<Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
					<Set name="lifeTime">0.5</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 1</KeyFrame>
						<KeyFrame>0.3, 1</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
				</Particle>
			</ParticleSystem>
			<ParticleSystem name="EmberLeftParticleRight" updateStage="RenderBackpack" updateState="Movement.Movement">
				<Emitter>
					<Set name="offset">20, -15</Set>
					<Set name="emissionInterval">0.025</Set>
					<Set name="infParticles">true</Set>
					<Set name="infLifeTime">true</Set>
					<Set name="particlesPerEmission">1</Set>
					<Set name="particlesToEmit">1</Set>
				</Emitter>
				<Particle angleRelativeToPlayerSpeed="true">
					<Set name="sprite">s_glitter_particle</Set>
					<Set name="inSpecificOrder">true</Set>
					<Set name="relativeToEmitter">false</Set>
					<Random name="offset" min="-8, -8" max="8, 8" />
					<Set name="renderAlignment">CENTER</Set>
					<Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
					<Set name="lifeTime">0.5</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 1</KeyFrame>
						<KeyFrame>0.3, 1</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
				</Particle>
			</ParticleSystem>
		</ParticleSystems>
		

		<RenderOptions>
			<Default>
				<Set name="ShouldHover">true</Set>
				<Set name="HideParticlesOnTheaterSeat">true</Set>
			</Default>
		</RenderOptions>
		<VariableMap>
			<Set name="hair_rotation">0, 0, 0, 1</Set>
			<Set name="hair_position">-9, -15, 0</Set>

			<Set name="hair_position_SECOND">9, -15, 0</Set>
			<Set name="hair_rotation_SECOND">0, 0, 0, 1</Set>
		</VariableMap>
	</Data>

	<RenderRules>
		<Update>
			<StopIf>
				<IsZombified>true</IsZombified>
				<IsWearing slot="SHIRT">ITEM_ID_TACTICAL_STEALTH_DEVICE</IsWearing>
			</StopIf>
			<AvatarTransform class="FootPosition">
				<Set name="foot1dy">0</Set>
				<Set name="foot2dy">0</Set>
				<Set name="foot1y">0</Set>
				<Set name="foot2y">0</Set>
			</AvatarTransform>
		</Update>
		<AddClothingParticles>
			<StopIf type="or">
				<IsZombified>true</IsZombified>
				<IsWearing slot="SHIRT">ITEM_ID_TACTICAL_STEALTH_DEVICE</IsWearing>
				<IsWearing slot="SHOES">ITEM_ID_STAR_FIGHTER_REBEL_RAIDER</IsWearing>
				<IsWearing slot="SHOES">ITEM_ID_STAR_FIGHTER_IMPERIAL_ENFORCER</IsWearing>
			</StopIf>
		</AddClothingParticles>
		<RenderBackpack>
			<StopIf>
				<IsAction>DIE</IsAction>
				<IsWearing slot="SHIRT">ITEM_ID_TACTICAL_STEALTH_DEVICE</IsWearing>
				<IsSleepingOnaBed>true</IsSleepingOnaBed>
			</StopIf>

			<ParticleSystemRender name="EmberLeftParticleLeft" />
			<ParticleSystemRender name="EmberLeftParticleRight" />
			
			<SpriteRender name="s_back_strap" scale="1,1" offset="0,0" alignment="DOWN_CENTER"/>

			<Group>
				<Translate>hair_position</Translate>
				<Rotate>hair_rotation</Rotate>
				<SpriteRender name="s_wing" blend="PREMULTIPLIED_ALPHA" drawShadow="true" alignment="RIGHT_CENTER"  onState="Facing.Right"/>
				<SpriteRender name="s_wing" blend="PREMULTIPLIED_ALPHA" drawShadow="true" alignment="LEFT_CENTER"  onState="Facing.Left"/>
			</Group>

			<Group>
				<Translate>hair_position_SECOND</Translate>
				<Rotate>hair_rotation_SECOND</Rotate>
				<SpriteRender name="s_wing_right" flip="1,0" blend="PREMULTIPLIED_ALPHA" drawShadow="true" alignment="LEFT_CENTER"  onState="Facing.Right"/>
				<SpriteRender name="s_wing_right" flip="1,0" blend="PREMULTIPLIED_ALPHA" drawShadow="true" alignment="RIGHT_CENTER"  onState="Facing.Left"/>
			</Group>
      <StopIf>
        <IsRenderMod>RENDER_MOD_MINI_YOU</IsRenderMod>
      </StopIf>
		</RenderBackpack>
	</RenderRules>
</ItemRenderer>